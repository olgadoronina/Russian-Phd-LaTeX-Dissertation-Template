\chapter{Динамическая адаптация сетки} \label{ch:ch2}

\section{Метод движения сетки}
Подробное описание и исследование адаптивных методов движения сетки было проведено Хуанг и Рассел в их монографии~\cite{huang_adaptive_2011}. Основная идея этого подхода состоит в построении взаимно-однозначного отображения между физической $\Omega$ и вычислительной $\Omega_c$  областями, описываемыми в одномерном случае как:
\begin{align}
\Omega:&\ x_0=a<x_1<\dots<x_N = b \\
\Omega_c:&\ \xi_0=0<\xi_1<\dots<\xi_N = 1,\quad \text{где}\quad \xi_j = \frac{(j-1)}{(N-1)}
\end{align}

Будем искать такую сетку $x_1 = a<x_2<\dots<x_N=b$, которая равномерно распределяет заранее заданную функцию плотности узлов сетки  $\rho(x) > 0$ по отрезкам
\begin{equation}
\int_{x_1}^{x_2}\rho(x)dx = \cdots = \int_{x_{N-1}}^{x_N}\rho(x)dx
\label{eq:eq1}
\end{equation}
Обозначим функцию отображения вычислительной области $\Omega_c$  в физическую $\Omega$ через $x(\xi)$. Принимая во внимание равенства~\eqref{eq:eq1} и определение координат $\xi$, имеет место следующее соотношение
\begin{equation}
\int_{a}^{x(\xi)}\rho(x)dx = \xi \int_{a}^{b}\rho(x)dx
\label{eq:equidistribution}
\end{equation}
Дифференцируя~\eqref{eq:equidistribution} по переменной $\xi$ можно видеть, что функция   удовлетворяет следующей краевой задачи для квазилинейного дифференциального уравнения второго порядка
\begin{equation}
\frac{d}{d\xi}\left(\rho(x)\frac{dx}{d\xi} \right) = 0, \quad x(0)=a, \ x(1) = b.	
\label{eq:euler-lagrange}
\end{equation}
Несложно показать, что уравнение краевой задачи~\eqref{eq:euler-lagrange} является уравнением Эйлера-Лагранжа, определяющее решение вариационной задачи о минимизации функционала 
\begin{equation}
I[x] = \frac{1}{2}\int_{0}^{1}\left(\rho(x)\frac{dx}{d\xi} \right)^2d\xi.
\label{eq:functional}
\end{equation}
Следовательно, искомое преобразование $x(\xi)$  можно трактовать как решение вариационной задачи~\eqref{eq:functional}, минимизирующей энергию отображения.

В случае непрерывного перемещения сетки уравнение~\eqref{eq:euler-lagrange} для нахождения отображения  заменяется параболическим уравнением~\cite{huang_practical_2001}
\begin{equation}
\frac{\partial x}{\partial t} = \frac{1}{\tau \rho}\frac{\partial}{\partial \xi}\left(\rho(x)\frac{\partial x}{\partial \xi} \right),
\label{eq:MMPDE5}
\end{equation} 
где настроечный параметр  $\tau$ определяет масштаб времени при решении нестационарного уравнения.

В двумерном случае для определения функции отображения  $x(\xi, \eta)$ вычислительной области $\Omega_c$  в физическую $\Omega$  используется вариационный принцип, позволяющий получить разрешающее уравнение на основе минимизации следующего функционала~\cite{huang_moving_1998, henderson1997nonlinear}
\begin{equation}\label{eq:functional2d}
I[\boldsymbol\xi] = \frac{1}{2} \int_{\Omega}\left[\left(\mathbf{G}^{-1}\nabla\xi\cdot\nabla\xi\right)+\left(\mathbf{G}^{-1}\nabla\eta\cdot\nabla\eta\right)\right]d\mathbf{x}\ ,
\end{equation}
где  $\boldsymbol{\xi}(\xi, \eta)$ – вектор координат вычислительного пространства, $\nabla = \partial/\partial x, \partial/\partial y$   – оператор градиента и $\mathbf{G}$  –   $2\times2$ симметричная положительно определённая матрица, обычно называемая \textit{мониторинговой функцией}. Функция, минимизирующая функционал, удовлетворяет уравнению Эйлера-Лагранжа:
\begin{equation}
\nabla \cdot \left(\mathbf{G^{-1}\nabla \boldsymbol\xi}\right) = 0.
\end{equation}

Методы построения движущихся сеток на основе решения уравнения в частных про-изводных (MMPDE) выводится из уравнения градиентного потока (переноса градиента) для функционала $I[\boldsymbol\xi]$. В работах~\cite{huang_moving_1998, henderson1997nonlinear} это уравнение определяется следующим образом
\begin{equation}
\tau \sqrt{g} \frac{\partial \boldsymbol\xi}{\partial t} = \frac{\delta I[\boldsymbol\xi]}{\delta \boldsymbol\xi}
\end{equation}
или
\begin{equation}\label{eq:MMPDE}
\tau \sqrt{g} \frac{\partial \boldsymbol\xi}{\partial t} =\nabla \cdot \left(\mathbf{G^{-1}\nabla \boldsymbol\xi}\right),
\end{equation}
где $g =\mathrm{det}(\mathbf{G})$.

Для проведения вычисления необходимо знать отображение  $ \mathbf{x}( \boldsymbol\xi)$. Обращая уравнение~\eqref{eq:MMPDE} (меняя местами зависимые и независимые переменные), получаем уравнение для нахождения  $ \mathbf{x}( \boldsymbol\xi)$.
\begin{equation}
\begin{split}
\frac{\partial \mathbf{x}}{\partial t} = 
& - \frac{\mathbf{x}_{\xi}}{\tau J \sqrt{g}}
\left\{ 
	\frac{\partial}{\partial \xi}    \frac{\left(\mathbf{G x_{\eta}x_{\eta}}\right)}{Jg} - 
	\frac{\partial}{\partial \eta} \frac{\left(\mathbf{G x_{\eta}x_{\xi}}   \right)}{Jg} 
\right\}\\
& - \frac{\mathbf{x}_{\eta}}{\tau J \sqrt{g}}
\left\{ 
\frac{\partial}{\partial \xi}    \frac{\left(\mathbf{G x_{\xi}x_{\eta}}\right)}{Jg} - 
\frac{\partial}{\partial \eta} \frac{\left(\mathbf{G x_{\xi}x_{\xi}}   \right)}{Jg} 
\right\}
\end{split}
\end{equation}
где  $J = x_{\xi}y_{\eta} - x_{\eta}y_{\xi}$ есть матрица Якоби отображения $\mathbf{x}(\boldsymbol\xi)$.

Остановимся подробнее на выборе мониторинговой функции $\mathbf{G}$  в двумерном случае. Поскольку матрица $\mathbf{G}$ симметрична, то её спектральное разложение представимо в виде 
\begin{equation}
\mathbf{G} = \lambda_1\mathbf{v}_1\mathbf{v}_1^T + \lambda_2\mathbf{v}_2\mathbf{v}_2^T,
\label{eq:general_monitor_func} 
\end{equation}
где $\lambda_1$ и $\lambda_2$ – положительные собственные значения (матрица $\mathbf{G}$  положительно определена), а $\mathbf{v}_1$  и $\mathbf{v}_2$  – соответствующие нормированные собственные векторы, причём  $\mathbf{v}_1$, $\mathbf{v}_2$  взаимно ортогональны.

В настоящей работе мониторинговая функция выбирается согласно методу Винслоу~\cite{winslow_adaptive-mesh_1981}
\begin{equation}
\lambda_1 = \lambda_2 = \rho(x,y)
\end{equation}
Тогда мониторинговая функция~\eqref{eq:general_monitor_func} принимает вид диагональной матрицы с равными диагональными элементами
\begin{equation}
\mathbf{G}(x,y) = \rho(x,y)\mathbf{I}.
\label{eq:monitor_func} 
\end{equation}
Следовательно, подразумевается, что деформация сетки будет происходить изотропно в направлении градиента функции $ \rho(x,y)$, называемой \textit{функцией плотности узлов сетки}.

Функционал~\eqref{eq:functional2d} с мониторинговой функцией~\eqref{eq:monitor_func} приобретает вид 
\begin{equation}
I[\xi,\eta] = \frac{1}{2}\iint\limits_{\Omega}\frac{1}{\rho(x,y)}\left(|\nabla \xi|^2+|\nabla \eta|^2\right)dxdy
\label{eq:2Dfunctional}
\end{equation}
и тогда, согласно, \eqref{eq:MMPDE} уравнение метода MMPDE запишется как 
\begin{equation}
\tau \rho\frac{\partial \boldsymbol\xi}{\partial t} = \nabla\cdot\left(\frac{1}{\rho}\nabla \boldsymbol\xi \right)
\label{eq:MMPDE2D}
\end{equation}
Преобразуя уравнение~\eqref{eq:MMPDE2D} для зависимой переменной  $\mathbf{x}( \boldsymbol\xi)$, имеем~\cite{huang_practical_2001}
\begin{equation}\label{eq:movmesheq}
\frac{\partial \mathbf{x}}{\partial t} = \frac{1}{\tau \rho} 
\left[
|\nabla \xi|^2 \frac{\partial }{\partial \xi}\rho \frac{\partial \mathbf{x}}{\partial \xi} +
\nabla \xi \nabla\eta \left( \frac{\partial }{\partial \xi}\rho \frac{\partial \mathbf{x}}{\partial \eta} +\frac{\partial }{\partial \eta}\rho \frac{\partial \mathbf{x}}{\partial \xi} \right) +
|\nabla \eta|^2 \frac{\partial }{\partial \eta}\rho \frac{\partial \mathbf{x}}{\partial \eta}
\right]
\end{equation}

\section{Упрощенная формулировка метода движения сетки}
Как показано в работах~\cite{jasak_automatic_2006, tukovic_moving_2012}, вместо уравнения движения сетки~\eqref{eq:movmesheq} для широкого круга задач допустимо использование его упрощенной формулировки, приводящей к уравнению Лапласа вида
\begin{equation}\label{eq:jasak}
\frac{\partial \mathbf{x}}{\partial t} = \frac{1}{\tau \rho} 
\left[
 \frac{\partial }{\partial \xi}\rho \frac{\partial \mathbf{x}}{\partial \xi} +
 \frac{\partial }{\partial \eta}\rho \frac{\partial \mathbf{x}}{\partial \eta}
\right].
\end{equation}
По всей видимости, такое упрощение допустимо, если рассматривается изотропная адаптация при относительно слабой степени требуемого сгущения сетки. При таких постановках использование уравнения движения сетки~\eqref{eq:jasak} не приводит к фатальному ухудшению качества адаптированной сетки и позволяет получать вполне приемлемые численные результаты. 

Следует заметить, что численная реализация расчета с использованием уравнения~\eqref{eq:jasak} существенно проще, по сравнению с полной формулировкой~\eqref{eq:movmesheq} и требует заметно меньше вычислительных ресурсов. В приводимых ниже примерах для отработки общего алгоритма мы используем упрощенную формулировку, в то время как рассмотрение общего случая планируется в ближайшем будущем.
