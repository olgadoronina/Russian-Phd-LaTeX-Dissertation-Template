\chapter{Математическое описание аэродинамики движущихся тел на основе метода погруженных границ на подвижной сетке} \label{app:A}
Для описания движущихся тел в качестве наиболее удобного подхода все большее распространение приобретают методы погруженных границ (в англоязычной научной литературе – Immersed Boundary Conditions или IBC метод)~\cite{mittal2005immersed, boiron2009high, brown2014characteristic}.
Методы погруженных границ составляют целый класс методов, позволяющих обеспечить выполнение граничных условий на поверхности обтекаемых тел в процессе численного расчёта без описания ее геометрии сеточными узлами. Это означает, что может быть использована «сплошная» расчётная сетка, покрывающая всю область определения задачи, включая препятствие. 

Взаимодействие твёрдого тела и окружающей среды при этом может моделироваться несколькими способами. Один из них – это модификация дискретизированных газодинамических уравнений, основанная на геометрическом анализе пространственного расположения используемого разностного шаблона относительно границы твёрдого тела. Другой способ заключается во введении штрафных функций непосредственно в исходные уравнения. Они добавляются в виде источниковых членов и имеют ненулевое значение только в узлах расчётной сетки, находящихся внутри твёрдого тела.

Применение погруженных граничных условий заметно упрощает воспроизведение движения тел даже, если они имеют сложную геометрическую форму. Так, при использовании штрафных функций, изменение пространственного положения обтекаемого тела на каждом временном шаге сводится лишь к изменению источниковых членов в решаемых уравнениях, а не к ресурсоемкому перестроению расчётной сетки, требуемому при описании границы сеточными узлами.

\section{Математическая модель для неподвижных сеток} \label{app:A1}
Следуя методу Бринкмана штрафных функций, система уравнений Навье-Стокса, описывающая течение в области $\Omega_f$ вокруг твёрдого тела $\Omega_B$ с границей $\partial \Omega_B$ , модифицируется следующим образом~\cite{mittal2005immersed, boiron2009high}:
\begin{equation}
\left\{
\begin{aligned}
&\mathbf{Q}_t + \nabla \cdot \mathbf{F}(\mathbf{Q})+S_{\eta} = \nabla\cdot\mathbf{F}_{\nu}(\nabla \mathbf{Q}), \quad (\mathbf{x}, t) \in \Omega_f \cup \Omega_B \cup \partial\Omega_B\\
&\mathbf{Q}(t=0) = \mathbf{Q}_0(\mathbf{x})\\
&S_{\eta} = \eta^{-1} \chi (0, \rho(\mathbf{u} -\mathbf{U}_B), E)
\end{aligned}
\right. ,
\label{eq:NS}
\end{equation}
где   $\mathbf{Q} = (\rho, \rho\mathbf{u}, E)$ – вектор безразмерных консервативных переменных,  $\mathbf{F}$ и  $\mathbf{F}_{\nu}$ – конвективные и вязкие потоки, $\rho$ – плотность газа,  $\mathbf{u}$ – вектор скорости, $\mathbf{U}_B$   – скорость движения твёрдого тела,  $E$ – полная энергия. Система замыкается уравнением состояния идеального газа: $p = (\gamma - 1)\rho \varepsilon$, где $\varepsilon$  – внутренняя энергия, $\gamma = 1.4$  – показатель адиабаты, а полная энергия определяется соотношением:  $E = \rho \varepsilon + \rho\mathbf{u}^2/2$.

Характеристическая функция $\chi$ определяет геометрическое место обтекаемого тела:
\begin{equation}
\chi = \left\{
\begin{aligned}
&1, \quad \mathbf{x}\in \overline{\Omega}_B\\
&0, \quad \mathbf{x}\in \Omega_f
\end{aligned}
\right. .
\label{eq:chi}
\end{equation}

Как видно из~\eqref{eq:NS}, источниковые члены $S_\eta$, называемые штрафными функциями, добавляются только в уравнения импульса и энергии. В точках сетки, где характеристическая функция  $\chi\ne0$ (т.е. внутри препятствия), система трансформируется в модель Бринкмана пористой среды с параметром $\eta$, определяющим ее проницаемость: $0<\eta<<1$: чем меньше коэффициент $\eta$, тем точнее воспроизводятся граничные условия при  $\mathbf{x}\in\partial\Omega_B$.

В работе~\cite{abalakin2015} возможности данного метода были продемонстрированы на примере решения двумерных модельных задач по расчёту дозвукового и сверхзвукового течения вокруг цилиндра.  Работа~\cite{abalakin2018} демонстрирует численное решение задачи турбулентного обтекания трёхмерного цилиндра.
Для численного решения системы уравнений~\eqref{eq:NS} использовалась оригинальная EBR (Edge-Based Reconstruction) схема повышенной точности, основанная на квазиодномерной рёберно-ориентированной реконструкции переменных~\cite{abalakin2016edge}.
\section{Математическая модель для подвижных сеток}
Для описания течения на движущихся адаптивных (деформируемых) сетках использовался смешанный эйлерово-лагранжев (СЭЛ) подход~\cite{hirt1974arbitrary, golovizin1981} использования уравнений газовой динамики, как законов сохранения. Этот подход можно интерпретировать как промежуточное описание движения сплошной среды между эйлеровым подходом, использующим абсолютную систему координат и лагранжевым описанием, использующим систему координат, связанную с локальной скоростью движения среды. То есть выбирается такая система координат, которая не фиксирована по времени и не перемещается со скоростью среды. 

Рассмотрим систему координат, движущуюся со скоростью $\dot{\mathbf{x}}$, равной скорости деформации сетки $\mathbf{U}_M$. Рассмотрим интеграл от вектора консервативных производных по произвольному жидкому объёму $V(t)$. Тогда полная производная от жидкого объёма запишется следующим образом~\cite{budak2002}, с.259]
\begin{equation}\label{eq:integral_derivative}
\frac{d}{dt}\int \limits_{V(t)}\mathbf{Q}dV = \int \limits_{V(t)}\left[\mathbf{Q}_t + \nabla \cdot (\mathbf{Q}\dot{\mathbf{x}})\right]dV .
\end{equation}
Из законов сохранения~\eqref{eq:NS} следует, что $\mathbf{Q}_t = -\nabla \cdot \mathbf{F}(\mathbf{Q})-S_{\eta} + \nabla\cdot\mathbf{F}_{\nu}(\nabla \mathbf{Q})$. Подставляя частную производную по времени в~\eqref{eq:integral_derivative} получаем систему законов сохранения в СЭЛ форме
\begin{equation}\label{eq:integral_derivative2}
\frac{d}{dt}\int \limits_{V(t)}\mathbf{Q}dV = 
-\int \limits_{V(t)}\left[ \nabla \cdot(\mathbf{F} - \mathbf{Q}\dot{\mathbf{x}}) - \nabla\cdot\mathbf{F}_{\nu}(\nabla \mathbf{Q}) + S_{\eta} \right] dV .
\end{equation}
При заданном законе движения сетки  $\dot{\mathbf{x}} = \mathbf{U}_M$ система законов сохранения~\eqref{eq:integral_derivative2} определяет математическую модель необходимую для проведения расчётов на адаптивной сетке с использованием метода погруженных границ. Заметим, что при  $\dot{\mathbf{x}} = 0$ система~\eqref{eq:integral_derivative2} имеет эйлеровскую форму представления законов сохранения, а при $\dot{\mathbf{x}} = \mathbf{u}$  – систему законов сохранения в лагранжевой форме.
\section{Технология расчета системы газодинамических уравнений в СЭЛ форме на движущихся сетках с неизменной топологией для треугольной сетки}
Кратко разработанную технологию можно представить для решения системы~\eqref{eq:integral_derivative2} следующим образом. Для простоты дальнейших выкладок определим вязко-невязкий поток  $\mathbf{F(Q, \nabla Q)} \equiv \mathbf{F(Q)} - \mathbf{F}_{\nu}( \nabla \mathbf{Q})$  и положим равным нулю источниковый член (для дальнейших выкладок он не имеет принципиального значения). Для аппроксимации системы законов сохранения~\eqref{eq:integral_derivative2} будем использовать конечно-объёмный подход, который в равной степени применим как к статическим сеткам, так и к меняющимся по любому непрерывному закону. Определим переменные в узлах неструктурированной сетки и будем рассматривать жидкий контрольный объём $V(t)$  в системе~\eqref{eq:integral_derivative2} как $i$-ую деформируемую сеточную ячейку $K_i(t)$, являющуюся контрольным объёмом, построенным вокруг узла $i$. Тогда для записи конечно-объёмной схемы для системы~\eqref{eq:integral_derivative2} заменим в правой части этой системы интегрирование по объёму интегрированием по поверхности  $\partial K_i(t)$. Получаем
\begin{equation}\label{eq:integral_derivative3}
\frac{d}{dt}\iint \limits_{K_i(t)} \mathbf{Q}dV + 
-\int \limits_{\partial K_i(t)}\mathbf{F(Q, \nabla Q)} \cdot \mathbf{n} \,dS - 
\int \limits_{\partial K_i(t)}\mathbf{Q}(\mathbf{U}_M\cdot \mathbf{n})dS = 0 ,
\end{equation}
где  $\mathbf{n}$ – нормаль к границе ячейки. Таким образом, интегральное уравнение, а, следовательно, и конечно-объёмная разностная схема приобретает дополнительное слагаемое, пропорциональное скорости движения граней сеточных ячеек.

При аппроксимации уравнений Эйлера или Навье-Стокса на движущихся неструктурированных сетках принципиально важным является одновременное обеспечение консервативности (выполнения законов сохранения) и геометрической консервативности (точной передачи однородного потока). Консервативность метода обеспечивается благодаря строгому следованию конечно-объёмному подходу. Для геометрической консервативности  аппроксимация уравнения~\eqref{eq:integral_derivative3} должна быть точной, если  $\mathbf{Q}$ не зависит от координат и времени. Второе слагаемое при этом зануляется, поэтому рассмотрим аппроксимацию третьего слагаемого. Она осуществляется по-разному при применении явных и неявных схем для интегрирования разностного уравнения~\eqref{eq:integral_derivative3}.

В случае многостадийной явной схемы (схемы Рунге-Кутта) необходимо на каждом временном подслое аппроксимировать последнее слагаемое в \eqref{eq:integral_derivative3} так, чтобы при $\mathbf{Q} = const$  аппроксимация оказывалась точной. Для этого будем использовать следующую аппроксимацию на грани двух контрольных объёмов с центрами в точках $R$ и $L$ $(\partial K_L(t)\cap\partial K_R(t) )$:
\begin{equation}\label{eq:approx}
\int \limits_{\partial K_i(t)}\mathbf{Q}(\mathbf{U}_M\cdot \mathbf{n})dS \approx \frac{\mathbf{Q}_L + \mathbf{Q}_R}{2} \int \limits_{\partial K_L(t)\cap\partial K_R(t)} \mathbf{U}_M\cdot \mathbf{n}\,dS,
\end{equation}
а оставшийся интеграл в правой части считать точно на каждый момент времени. В разработанной технологии в течение одного временного шага скорость движения сеточных узлов предполагается постоянной. Если $K_i(t)$  есть барицентрический\footnote{Под барицентрическим контрольным объёмом для треугольной сетки понимается многогранник, границей которого, является ломаная соединяющая центры рёбер и центры тяжести треугольников.}  контрольный объём, то радиус-вектор каждой вершины этого объёма является линейной комбинацией радиус-векторов сеточных узлов. В результате средняя скорость по каждой грани сеточной ячейки также является постоянной в пределах шага, а интеграл в правой части \eqref{eq:integral_derivative3} за счёт изменения площадей граней – линейной функцией времени. Величины контрольных объёмов, следовательно, являются квадратичной функцией. Поэтому, чтобы выполнялась геометрическая консервативность в \eqref{eq:integral_derivative3}, необходимо использовать метод Рунге-Кутта не ниже 2-го порядка.

Для записи неявного метода Эйлера проинтегрируем \eqref{eq:integral_derivative3} по времени. Получаем
\begin{equation}\label{eq:integral_time}
\iint \limits_{K_i(t^{n+1})} \mathbf{Q}dV  - \iint \limits_{K_i(t^{n})} \mathbf{Q}dV+ 
\int \limits_{t^n}^{t^{n+1}} \int \limits_{\partial K_i(t)}\mathbf{F(Q, \nabla Q)} \cdot \mathbf{n} \,dS - 
\int \limits_{t^n}^{t^{n+1}} \int \limits_{\partial K_i(t)}\mathbf{Q}(\mathbf{U}_M\cdot \mathbf{n})dS = 0 ,
\end{equation}
Чтобы аппроксимация была точной при  $\mathbf{Q} = const$, запишем для третьего слагаемого в \eqref{eq:integral_derivative3} аппроксимацию
\begin{equation}\label{eq:approx_time}
\int \limits_{t^n}^{t^{n+1}} \int \limits_{\partial K_i(t)}\mathbf{Q}(\mathbf{U}_M\cdot \mathbf{n})dS \approx \frac{\mathbf{Q}^{n+1}_L + \mathbf{Q}^{n+1}_R}{2} \int \limits_{t^n}^{t^{n+1}} \int \limits_{\partial K_L(t)\cap\partial K_R(t)} \mathbf{U}_M\cdot \mathbf{n}\,dS.
\end{equation}
Интеграл в правой части также вычисляется аналитически.

Аппроксимация второго слагаемого в \eqref{eq:integral_derivative3} для конвективной части системы уравнений Навье-Стокса осуществляется при помощи схем с квазиодномерной реконструкцией переменных, как и в случае недеформируемой сетки. Они основаны на том, что повышение порядка точности осуществляется посредством квазиодномерной рёберно-ориентированной реконструкции значений физических переменных в центр ребра ~\cite{abalakin2016edge}. Коэффициенты реконструкции можно брать с недеформированной сетки или пересчитывать на каждом временном слое. 

Аппроксимация вязких членов в уравнении Навье-Стокса проводится методом Галёркина на основе полиномов 1-го порядка как в случае покоящейся, так и в случае движущейся сетки и не требует внесения изменений. 




